# Static and Dynamic Rendering

넥스트에서, 라우트는 정적또는 동적으로 랜더 될 수 있다.

- 정적 라우트에서, 컴포넌트는 빌드 시 서버에서 랜더된다. 그 결과는 캐시되고 추가 요청에 사용된다.
- 동적 라우트에서, 컴포넌트는 요청 시에 서버에서 랜더된다.

## Static Rendering (Default)

기본적으로, 넥스트는 성능을 향상시키기 위해 정적 랜더 라우트를 사용한다.
즉 모든 랜더가 미리 완료되고 cdn을 통해 지리적으로 가까운 곳에서 유저에 제공된다.

## Static Data Fetching (Default)

기본적으로, 넥스트는 캐싱 동작을 특별히 하지 않는 fetch() 요청의 결과를 캐시한다.
이것은 페치 요청이 캐시 옵션을 사용하지 않으면 force-cache 옵션을 사용한다는 뜻이다.

만약 라우트의 페치 요청에 revalidate 옵션이 있다면, 라우트는 재확인 시에 리랜더 될 것이다.

## Dynamic Rendering

정적 랜더 중에, 동적 함수나 동적 페치 요청을 발견하면, 넥스트는 요청시에 동적 랜더로 모든 라우트를 변경한다.
캐시된 데이터 요청은 여전히 동적 랜더중에 사용될 수 있다.

| Data Fetching   | Dynamic Functions | Rendering |
| --------------- | ----------------- | --------- |
| Static (Cached) | No                | Static    |
| Static (Cached) | Yes               | Dynamic   |
| Not Cached      | No                | Dynamic   |
| Not Cached      | Yes               | Dynamic   |

데이터 페치가 캐시되었는지 여부에 관계없이 동적 함수가 항상 라우트로 동적 랜더링을 선택하는 것을 유의해라.
다른 말로, 정적 랜더링은 데이터 페치 동작 뿐 아니라, 라우트에서 사용되는 동적 함수에도 의존한다.

> Good to know: 넥스트는 미래에 하이브리드 서버 사이드 랜더링을 제공해, 모든 라우트가 아닌 레이아웃 혹은 페이지가 독립적으로 정적이거나 동적으로 될 수 있도록 할 예정이다.

### Dynamic Functions

동적 함수는 요청 시에 알 수 있는 정보(유저의 쿠키, 요청 해더, url 서치 파람)에 달려있다.
넥스트에서, 동적 함수는 다음과 같다:

- 서버 컴포넌트에서 cookies() 또는 headers() 사용은 모든 라우트를 요청시 동적 랜더한다.
- 클라이언트 컴포넌트에서 useSearchParams() 사용은 정적 랜더를 스킵하고 가까운 클라이언트 컴포넌트 부모의 서스펜스 바운더리 안에서 랜더 된다.
  - useSearchParams()을 사용하는 클라이언트 컴포넌트를 서스펜스로 감싸는 것을 추천한다. 이것은 클라이언트 컴포넌트를 정적 랜더하게 해준다.
- searchParams 페이지 프랍은 요청 시 동적 랜더한다.

## Dynamic Data Fetching

페치 요청시, 캐시 옵션을 no-store로 설정하거나 revalidate를 0으로 설정하면 동적 페치이다.

레이아웃 혹은 페이지의 모든 페치 요청의 캐시 옵션은 세그먼트 설정 객체로 설정할 수 있다.

---

## What I Learned

기본적으로는 정적 랜더링을 사용해 필요시에 동적으로 랜더하는 것을 알게되었다. 또 페치를 통해 캐시해 재사용하는 것도 알게되었다.
